= Познаём робота вместе
:toc:

== Подготовка
Текущие задания выполняются на мобильном роботе МРП309, но можно использовать и другие устройства семейства Arduino.

.Мобильный робот МРП309
image::pictures/mrp309.jpg[500, 500]

:arduinoide: https://www.arduino.cc/en/main/software#
Для программирования мобильного робота тебе понадобится среда разработки Arduino IDE, которую можно скачать здесь {arduinoide}


Запускаем Arduino IDE. Перед тобой открывается окно. В центре окна расположен *скетч* для написания кода (программы).

WARNING: Перед использованием Arduino IDE необходимо выполнить выбор порта загрузки, платы и микроконтроллера,
заходим в:

****
1.Инструменты => Плата. Выбираем Arduino Nano;

2.Инструменты => Процессор. Выбираем ATMega328;

3.Инструменты => Порт. Выбираем тот, которому соответствует наша подключенная плата, у меня это COM5.
****

Рассмотрим меню, которое расположено над скетчем.Когда ты напишешь свой код, необходимо убедится в том, что ты не сделал грубых ошибок. Эту проверку можно выполнить с помощью клавиши *Проверить*. Если проверка пройдет успешно, тогда можно смело загружать нашу программу на плату, при помощи клавиши *Загрузить*.

.Рабочее окно Arduino IDE
image::pictures/ArduinoIDE.png[500, 500]


== Урок 1. Знакомство со светодиодом
В данном уроке ты заставишь светодиод мигать.

TIP: Светодиод — это полупроводниковый прибор, трансформирующий электроток в видимое свечение.

.Внешний вид светодиода
image::pictures/1.1.jpg[300, 300]

У светодиода есть два контакта: отрицательный - *катод* и положительный - *анод*.

.Обозначение светодиода на схеме
image::pictures/1.2.1.luminodeode.jpg[300, 300]



WARNING: Чтобы светодиод не сгорел, он включается в схему через резистор. Резистор подключается к положительному (аноду) контакту светодиода.
Важно подобрать правильный номинал резистора.

.Схема включения светодиода через резистор
image::pictures/1.2.2.luminodeode.jpg[300, 300]

=== Расчет номинала резистора

Чтобы светодиод работал исправно, а не сгорел при первом подключении его к питанию,
 необходимо правильно подобрать номинал резистора. Резистор будет забирать излишнее напряжение.

Расчет номинала резистора выполняется по формуле, взятой из закона Ома.


=== Ход работы

1. Установи Arduino Nano на кросс-плату;
2. Подключи светодиод. На кросс-плате их два (синий и красный), находятся в передней части кросс-платы. Выбери любой. Плюс светодиода подсоедини к пину D13 платы Arduino Nano, Минус светодиода подсоедини к любому  минусу контактной колодки (Схема 1). Как правило, контакт «плюс» соединяют красным проводом, «минус» – черным.;
+
image::pictures/1.2.3.luminodeode.jpg[700, 700]

3. Подключи устройство к компьютеру через последовательный порт и загрузи на него код:
+
....
//Код, позволяющий мигать светодиодом

void setup()
{
  pinMode(13, OUTPUT);         // Задаем пин 13 как выход
}

void loop()
{
  digitalWrite(13, HIGH);      // Включаем светодиод
  delay(1000);                 // Ждем одну секунду
  digitalWrite(13, LOW);       // Выключаем светодиод
  delay(1000);                 // Ждем одну секунду
}
....

Успех! Светодиод стал мигать с периодичностью в 1 секунду.
Изменяя значение внутри функции delay() (задержка), мы можем регулировать частоту миганий. В нашем случае установлено значение 1000 мс (миллисекунд), что соответствует 1 секунде.

Давай рассмотрим нашу программу подробнее.

TIP: В любом скетче Arduino IDE должны присутствовать две функции *setup()* и *loop()*, иначе при проверке кода вылезет ошибка.

* *setup()* - это функция с настройками микроконтроллера. Она выполняется единожды в начале программы при включении микроконтроллера.
В теле этой функции указываются параметры настройки, например выбор пина, который используется на плате.
* *loop()* - это функция выполнения. Она циклична, То есть все то, что находится в теле этой функции (внутри фигурных скобок {}) непрерывно повторяется. В этой функции описываются основные действия нашей программы.
* *void* - Это ключевое слово, определяемое тип данных, которое возвращает функция. *void* означает, что функция не возвращает никаких значений.

....
pinMode(13, OUTPUT);         // Задаем пин 13 как выход
....

* *pinMode()* - это процедура, которая устанавливает определенный пин в соответствующий режим;
* *13* - номер пина, к которому подключен светодиод;
* *OUTPUT* - режим, в который мы устанавливаем наш пин. В нашем случае пин определен как выход. Это значит что информационный сигнал будет передоваться из этого пина на светодиод.

....
digitalWrite(13, HIGH);      // Включаем светодиод
....

* *digitalWrite()* - это функция, которая подает определенный уровень напряжения на *цифровой* пин. Либо LOW - низкий, либо HIGH - высокий;
* *13* - номер пина, к которому подключен светодиод;
* *LOW* - низкий уровень напряжения, который соответствует значению, 0 Вольт;
* *HIGH* - высокий уровень напряжения, соответствует значению, 5 Вольт.

....
delay(1000);                 // Ждем одну секунду
....

* *delay()* - функция, останавливающая выполнение программы на заданное количество миллисекунд (1000 мс = 1 с).

Молодец, а теперь попробуй выполнить задания.

=== Задания

1. Отредактируй программу таким образом, чтобы светодиод мигал с периодичностью в :

** 2 секунды;
** 5 секунд;
** 1/2 секунды.

2. Отредактируй программу так, чтобы светодиод горел постоянно.

3. Теперь сделай так, чтобы светодиод не горел (соответственно сама плата должна быть подключена к питанию).

== Урок 2. Знакомство с кнопкой

В данном уроке ты научишься использовать кнопку для управления светодиодом.

TIP: Кнопка - это простой механизм, замыкающий цепь. Пока кнопка нажата - цепь замкнута, кнопка опущена - цепь разомкнута.

image::pictures/2.1.button.jpg[300, 300]

=== Ход работы

1. Установи Arduino Nano на кросс-плату;
2. Подключи кнопку и светодиод, как показано на рисунке.
+
image::pictures/2.3.buttonLuminodeode.jpg[700, 700]

3. Подключи устройство к компьютеру через последовательный порт и загрузи на него код:
+
....
// Код для включения светодиода с помощью кнопки

int buttonPin = 12;           // Назначаем пин с кнопкой
int ledPin = 13;              // Назначаем пин со светодиодом
boolean buttonState = LOW;    // Состояние кнопки отжата

void setup()
{
  pinMode(buttonPin, INPUT); // Задаем пин с кнопкой как вход,
  pinMode(ledPin, OUTPUT);   // а пин со светодиодом - как выход
}

void loop()
{
  // Считываем значение кнопки
  buttonState = digitalRead(buttonPin);
  if (buttonState == HIGH)       // Если кнопка нажата
  {
    digitalWrite(ledPin, HIGH);  // Включаем светодиод
  }
  else                           // Иначе
  {
    digitalWrite(ledPin, LOW);   // Выключаем светодиод
  }
}
....

4. Теперь нажми и удерживай кнопку. Если ты все делал по указаниям, то при нажатии на кнопку светодиод должен загораться, а при отпускании кнопки - гаснуть.
+
Когда ты нажимаешь на кнопку, ты замыкаешь цепь и электрический ток поступает на пин D12, в дальнейшем наша программа обрабатывает этот сигнал и подает высокий уровень напряжения на пин D13, к которому подключен светодиод.

Давай рассмотрим нашу программу подробнее.

Часть функций ты видел в xref:Урок 1. Знакомство со светодиодом[уроке 1]

....
int buttonPin = 12;           // Назначаем пин с кнопкой
....

Данной строчкой мы создаем глобальную переменную с именем *buttonPin*, типа *int* (integer - целый тип данных) и присваиваем ей значение *12*.
Имя переменной может быть любым, но понятным для тебя. Значение должно соответствовать пину, который ты выбрал, а тип переменной мы выбрали целый по причине того, что пины на плате обозначаются целыми числами (12, 13, 14 и тп.), а не дробными (0,5, 0,8 и тп.).

TIP: В программе каждая переменная имеет имя, тип данных и значение.

TIP: *Глобальные переменные* - это переменные, которые доступны всей программе, включая подпрограммы (пользовательские функции). *Локальные переменные* - переменные, определенные внутри подпрограммы (пользовательской функции). Они доступны только внутри функции, в которой они определены.

....
boolean buttonState = LOW;    // Состояние кнопки отжата
....

Переменная *buttonState* необходима нам для того, чтобы отследить состояние нашей кнопки. У нее может быть 2 состояния: нажата и отжата.
Поэтому мы создаем переменную типа *boolean* c начальным значением *LOW* (в ходе программы это значение будет изменяться).

* *boolean* - тип данных, принимающий всего два возможных значения (true (истина) или false (ложь); 1 или 0; LOW (низкий уровень напряжения) или HIGH (высокий уровень напряжения))

....
pinMode(buttonPin, INPUT); // Задаем пин с кнопкой как вход
....

* *pinMode()* - это процедура, которая устанавливает определенный пин в соответствующий режим;
* *buttonPin* - имя пина, к которому подключен светодиод. В xref:Урок 1. Знакомство со светодиодом[уроке 1] мы не задавали имя пину, а писали просто номер пина. Правильнее задавать имя для всех переменных;
* *INPUT* - режим, в который мы устанавливаем наш пин. В нашем случае пин определен как *вход*. Это значит что информационный сигнал будет передаваться из вне на этот пин;

....
buttonState = digitalRead(buttonPin);
....

С помощью функции *digitalRead()*, программа считывает значение с переменной *buttonPin* и присваивает его нашей переменной *buttonState*.

* *digitalRead()* - функция, считывающая значение с указанного пина. Возвращает либо LOW, либо HIGH;

....
if (buttonState == HIGH)       // Если кнопка нажата
{
  digitalWrite(ledPin, HIGH);  // Включаем светодиод
}
else                           // Иначе
{
  digitalWrite(ledPin, LOW);   // Выключаем светодиод
}
....

В данном месте программы мы выполняем состояние кнопки: нажата или нет. Используя при этом конструкцию *if, else*
